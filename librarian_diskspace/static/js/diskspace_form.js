// Generated by CoffeeScript 1.10.0
(function(window, $) {
  var diskForm, submitData, url;
  diskForm = $('.form');
  url = diskForm.attr('action');
  submitData = function(t, data) {
    var res, uuid;
    uuid = data.consolidate;
    res = $.post(url, data);
    res.done(function(data) {
      var message, resData;
      resData = $.parseJSON(res.responseText);
      if (resData.error) {
        message = resData.error;
      } else {
        message = resData.success;
      }
      return t.html("<p class='consolidate o-form-error'>" + message + "</p>");
    });
    return res.fail(function() {
      var message;
      message = "Critical failure, see librarian log for the traceback";
      return t.html("<p class='consolidate o-form-error'>" + message + "</p>");
    });
  };
  return diskForm.on('submit', function(e) {
    var data, t, uuid;
    t = $(this);
    e.preventDefault();
    uuid = t.attr('id');
    data = t.serialize();
    return submitData(t, {
      'consolidate': uuid
    });
  });
})(this, this.jQuery);
